{
  "name": "Foxtrot_DataFlow_Parent",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        620,
        500
      ],
      "id": "3c40f106-32d5-45d8-bd7d-3c9ddc14bd4f",
      "name": "When clicking 'Execute workflow'"
    },
    {
      "parameters": {
        "resource": "organization",
        "owner": {
          "__rl": true,
          "value": "Team-Foxtrot-GIKI",
          "mode": "name"
        }
      },
      "type": "n8n-nodes-base.github",
      "typeVersion": 1.1,
      "position": [
        920,
        500
      ],
      "id": "11398526-e0df-4b05-8921-24438c5b6c73",
      "name": "Get repositories for an organization",
      "webhookId": "2881a227-837b-419a-b6fb-d025d36086f8",
      "credentials": {
        "githubApi": {
          "id": "5hlVXiIYuzDQjW7T",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1260,
        500
      ],
      "id": "6e27cb43-8906-4b0d-a574-f2d4db10bb76",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "dQ8JvyEqvevIw6gXitcq5",
          "mode": "list",
          "cachedResultUrl": "/workflow/dQ8JvyEqvevIw6gXitcq5",
          "cachedResultName": "Foxtrot_DataFlow_Child"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {
          "waitForSubWorkflow": true
        }
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        1580,
        500
      ],
      "id": "e76591b7-e661-42b8-a1d9-4ae5ee08d068",
      "name": "Call 'Foxtrot_DataFlow_Child'",
      "alwaysOutputData": true,
      "retryOnFail": true
    },
    {
      "parameters": {
        "content": "# üöÄ Foxtrot DataFlow ‚Äî Parent Orchestrator\n\nOrchestrates the **entire data ingestion pipeline** for the `Team-Foxtrot-GIKI` GitHub organization.\n\n### How It Works\n1. Fetches **all repositories** from the GitHub org\n2. Loops through each repo **one at a time** (batch size = 1)\n3. Calls the **Child Workflow** to process each repo\n4. Waits for the child to finish before moving to the next repo\n\n---\n\n| Property | Value |\n|---|---|\n| **Organization** | `Team-Foxtrot-GIKI` |\n| **Processing** | Sequential (one repo at a time) |\n| **Child Workflow** | `Foxtrot_DataFlow_Child` |\n| **Est. Runtime** | ~5‚Äì10 min per repo |"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        380,
        80
      ],
      "typeVersion": 1,
      "id": "e1ac880c-a1a3-4a28-88d1-0045877c6266",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "### üü¢ Step 1 ¬∑ Trigger\n\nClick **Execute Workflow**\nto start the entire pipeline.\n\n_Manual trigger only ‚Äî\nno schedule configured._"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        556,
        400
      ],
      "typeVersion": 1,
      "id": "a1000001-0000-4000-8000-000000000001",
      "name": "Note: Trigger"
    },
    {
      "parameters": {
        "content": "### üêô Step 2 ¬∑ Fetch All Repos\n\nGitHub API call to list **every\nrepository** in the organization.\n\nReturns ~15 repos with full\nmetadata (name, id, visibility‚Ä¶)"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        840,
        400
      ],
      "typeVersion": 1,
      "id": "a1000002-0000-4000-8000-000000000002",
      "name": "Note: Fetch Repos"
    },
    {
      "parameters": {
        "content": "### üîÅ Step 3 ¬∑ Batch Loop\n\nIterates over repos **one by one**\n(batch size = 1).\n\n`done` output ‚Üí all repos done ‚úÖ\n`loop` output ‚Üí process next repo üîÑ\n\n_Sequential ensures we don't\noverwhelm the GitHub API._"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1160,
        380
      ],
      "typeVersion": 1,
      "id": "a1000003-0000-4000-8000-000000000003",
      "name": "Note: Loop"
    },
    {
      "parameters": {
        "content": "### üì§ Step 4 ¬∑ Call Child Workflow\n\nSends the current repo object\nto `Foxtrot_DataFlow_Child`.\n\nThe child handles:\n‚Üí Recursive file listing\n‚Üí Filtering junk directories\n‚Üí Filtering by file extension\n‚Üí Fetching file contents\n‚Üí Embedding into Pinecone\n\n‚úÖ **alwaysOutputData** = true\n_(empty repos won't break the loop)_\n\n‚úÖ **retryOnFail** = true\n_(transient errors auto-retry)_"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1500,
        360
      ],
      "typeVersion": 1,
      "id": "a1000004-0000-4000-8000-000000000004",
      "name": "Note: Call Child"
    },
    {
      "parameters": {
        "content": "### ‚ö†Ô∏è First-Time Setup Instructions\n\n1. **Import** the `Foxtrot_DataFlow_Child` workflow first\n2. Copy the Child's **Workflow ID** from its URL bar\n3. Open the \"Call Foxtrot_DataFlow_Child\" node ‚Üí paste the Workflow ID\n4. Configure your **GitHub API credentials** (token needs `repo` scope)\n5. Configure **Pinecone** and **HuggingFace** credentials in the child workflow\n6. Click **Execute Workflow** to run the full pipeline"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        380,
        700
      ],
      "typeVersion": 1,
      "id": "a1000005-0000-4000-8000-000000000005",
      "name": "Note: Setup"
    },
    {
      "parameters": {
        "content": "### üèóÔ∏è Architecture Overview\n\n```\nParent (this workflow)\n  ‚îÇ\n  ‚îú‚îÄ Fetches all repos from GitHub org\n  ‚îÇ\n  ‚îî‚îÄ For each repo (one-by-one):\n      ‚îÇ\n      ‚îî‚îÄ Calls Child Workflow\n          ‚îú‚îÄ Lists files recursively\n          ‚îú‚îÄ Filters out junk dirs (.git, .venv, node_modules‚Ä¶)\n          ‚îú‚îÄ Filters files by extension (.py, .md, .lua‚Ä¶)\n          ‚îú‚îÄ Fetches file content via GitHub API\n          ‚îî‚îÄ Embeds into Pinecone (namespace = repo name)\n```\n\n**Vector DB:** Pinecone (index: `foxtrot`)\n**Embeddings:** HuggingFace Inference API"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1060,
        700
      ],
      "typeVersion": 1,
      "id": "a1000006-0000-4000-8000-000000000006",
      "name": "Note: Architecture"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking 'Execute workflow'": {
      "main": [
        [
          {
            "node": "Get repositories for an organization",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get repositories for an organization": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Foxtrot_DataFlow_Child'": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Call 'Foxtrot_DataFlow_Child'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "f0a54d53-cb83-4126-b612-b4f8b6bfe1af",
  "meta": {
    "instanceId": "84477c8594e4e5fa1a85df07d16feed30068678c5643e6e958310722165b467f"
  },
  "id": "5vc2Cj4jfEFlW0Xipkacj",
  "tags": []
}
